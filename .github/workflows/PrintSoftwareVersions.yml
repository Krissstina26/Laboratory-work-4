name: Print Software Versions

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  bl-software-check:
    name: Business Logic – Versions
    runs-on: ubuntu-latest
    steps:
      - name: Pull Repository
        uses: actions/checkout@v4

      - name: Show OS Information
        run: |
          echo "Operating System Info:"
          lsb_release -a || cat /etc/os-release

      - name: Display .NET SDK Version
        run: |
          echo ".NET SDK Version:"
          dotnet --version

      - name: Display C# Compiler Info
        run: |
          echo "C# Compiler Version:"
          csc -version || echo "CSC compiler not installed"

  db-tools-check:
    name: Data Access – DB Versions
    runs-on: ubuntu-latest
    steps:
      - name: Relational DB Client (PostgreSQL)
        run: |
          echo "PostgreSQL Version:"
          psql --version || echo "PostgreSQL client not installed"

      - name: Install MongoDB
        run: |
          sudo apt-get update
          sudo apt-get install -y curl gnupg
          curl -fsSL https://pgp.mongodb.com/server-7.0.asc | \
            sudo gpg --dearmor -o /usr/share/keyrings/mongodb-server-7.0.gpg
          echo "deb [ arch=amd64 signed-by=/usr/share/keyrings/mongodb-server-7.0.gpg ] \
            https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse" | \
            sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list
          sudo apt-get update
          sudo apt-get install -y mongodb-org

      - name: JSON DB Check (MongoDB)
        run: |
          echo "MongoDB Version:"
          mongod --version

      - name: JSON Support in PostgreSQL
        run: |
          echo "Checking JSON support in PostgreSQL:"
          echo "Supported types: json, jsonb"

      - name: Docker Info for Databases
        run: |
          echo "Docker Version:"
          docker --version
